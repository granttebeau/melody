<%- include("partials/header") %>
<div class="container">
    <div class="row justify-content-center">
        <div class="col-4">
            <h1>Home screen</h1>
        </div>
        <div class="col-6">
            <form action="/new-post/home" method="POST">
                <div class="form-group">
                    <input class="form-control" type="text" placeholder="What song's on your mind?" name="content" required>
                </div>
                <div class="form-group">
                    <input class="form-control" type="text" placeholder="Song link" name="song" required>
                </div>
                <div class="form-group">
                    <input type="submit" value="Post" class="btn btn-primary btn-block">
                </div>
            </form>
            <ul class="posts">
                <% posts.reverse().forEach(post => {%>
                    <% if (post.content && post.song)  { %> 
                        <li class="post">
                            <p class="lead">@<a href="/profile"><%=post.author.username %></a> <span class="date" style="font-size: .7em;"><%=post.date%></span> </p>
                            <p class="lead"><span class="post-content"><%= post.content %></span></p>
                            <div class="spotify-embeds">
                                <div class="spotify-embed">
                                    <iframe class="rounded song-tile" src="<%= post.song %>"   frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                                </div>
                            </div>
                            <% if (post.author.id.equals(user._id)) { %>
                                <a href="/delete-post/<%= post._id %>/profile">Delete</a>
                            <% } %>
                        </li>
                    <% } %>
                <% })%>
            </ul>
        </div>
    </div>
</div>
<script src="/js/script.js"></script>
<%- include("partials/footer") %>
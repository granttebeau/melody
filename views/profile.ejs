<%- include("partials/header") %>
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-4">
            <h1> <%= user.fullName %></h1>
            <h3>@<%=user.username%></h3>
            <p><%= user.bio%></p>
            <img src="/profile/picture" style="width: 200px;"> <br>
            <a href="/logout">Log out</a>
        </div>
        <div class="col-6">
            <form action="/new-post/profile" method="POST">
                <div class="form-group">
                    <input class="form-control" type="text" placeholder="What song's on your mind?" name="content" required>
                </div>
                <div class="form-group">
                    <input class="form-control" type="text" placeholder="Song link" name="song" required>
                </div>
                <div class="form-group">
                    <input type="submit" value="Post" class="btn btn-primary btn-block">
                </div>
            </form>
            <% if (posts.length == 0) { %>
                <h4 class="text-center my-5">No posts yet...</h4>
            <% } %>
            <ul class="posts">
                <% posts.reverse().forEach(post => {%>
                    <li class="post">
                        <p class="lead">@<a href="/profile"><%=post.author.username %></a> <span class="date" style="font-size: .7em;"><%=post.date%></span> </p>
                        <p class="lead"><span class="post-content"><%= post.content %></span></p>
                        <iframe style="position: relative; z-index: 2;" src="<%= post.song %>" width="300" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
                        <% if (post.author.id.equals(user._id)) { %>
                            <a href="/delete-post/<%= post._id %>/profile">Delete</a>
                        <% } %>
                    </li>
                <% })%>
            </ul>
        </div>
    </div>
</div>

<script src="/js/script.js"></script>
<%- include("partials/footer") %>